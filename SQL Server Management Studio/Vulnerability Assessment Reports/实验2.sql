--***************************************
--              实验二
--***************************************

--（1）找出所有供应商的姓名和所在城市
SELECT SNAME,CITY
FROM S;

--（2）找出所有零件的名称、颜色、重量
SELECT PNAME,COLOR,WEIGHT
FROM P;

--（3）找出使用供应商S1所供应零件的工程号码
SELECT JNO
FROM SPJ
WHERE SNO='1';

--（4）找出工程项目J2使用的各种零件的名称及其数量
SELECT PNAME,QTY
FROM P,SPJ
WHERE P.PNO=SPJ.PNO AND SPJ.JNO='2';

--（5）找出上海厂商供应的所有零件号码
SELECT DISTINCT PNO
FROM SPJ
WHERE SNO IN
(SELECT SNO
FROM S
WHERE CITY='上海');

--（6）找出使用山海产的零件的工程名称
SELECT JNAME
FROM J
WHERE JNO IN
(SELECT JNO
FROM SPJ
WHERE SNO IN
(select SNO
FROM S
WHERE CITY='上海'));

--（7）找出没有使用天津产的零件的工程号码
SELECT DISTINCT JNO
FROM SPJ
WHERE SNO not IN
(SELECT SNO
FROM S
WHERE CITY='天津');

--（12）从基本表查询天津供应商的编号、姓名、状态和城市；
SELECT SNO ,SNAME,STATUS,CITY
FROM S
WHERE CITY='天津';

--(13)从基本表查询重量大于14的零件的名称、颜色和重量；
SELECT PNAME,COLOR,WEIGHT
FROM P
WHERE weight>14;

--(14)从基本表查询供应工程1零件1的供应商号码；
SELECT SNO
FROM SPJ
WHERE JNO='1' AND PNO='1';

--(15)从基本表查询供应数量大于200小于等于400的供应商姓名；
SELECT SNAME
FROM S
WHERE SNO IN
(SELECT SNO
FROM SPJ
WHERE QTY >200 AND QTY<=400);

--*********************************************************
--(16)从基本表查询没有使用天津供应商生产的红色零件的工程号；
--*********************************************************
USE SPJ
GO
SELECT DISTINCT JNO 
FROM SPJ
WHERE JNO NOT IN 
(SELECT JNO 
FROM S,SPJ ,P
WHERE S.SNO=SPJ.SNO AND P.PNO=SPJ.PNO AND COLOR='红' AND CITY='天津');
GO

--(17)从基本表查询所供应零件数量大于等于300的供应商编号；
SELECT DISTINCT SNO 
FROM SPJ
WHERE QTY>=300;

--*********************************************************
--(18)从基本表查询至少用了供应商1所供应的全部零件的工程号；
--*********************************************************
 --select JNO
 --from SPJ 
 --where 

--(19)计算每个各供应商供应零件的总数量。
SELECT SUM(QTY) AS ZONGSHULIANG
FROM SPJ 
GROUP BY SNO;

--3.自行设计一种需求，完成一个涉及到三个表的查询操作
--1、查询使用产地是精益的零件的工程名
SELECT JNAME 
FROM J 
WHERE JNO IN 
(SELECT JNO 
FROM S,SPJ ,P
WHERE S.SNO=SPJ.SNO AND J.JNO=SPJ.JNO AND SNAME ='精益');